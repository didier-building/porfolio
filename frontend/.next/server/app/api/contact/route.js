"use strict";(()=>{var e={};e.id=386,e.ids=[386],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5315:e=>{e.exports=require("path")},3853:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>x,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>R,staticGenerationAsyncStorage:()=>f});var s={};r.r(s),r.d(s,{POST:()=>d});var o=r(9303),a=r(8716),n=r(670),i=r(7070);let c=require("fs/promises");var u=r(5315);let p=require("fs"),l=new Map;async function d(e){try{let t=e.headers.get("x-forwarded-for")||e.headers.get("x-real-ip")||"unknown";if(!function(e){let t=`contact_${e}`,r=Date.now(),s=l.get(t);return!s||r-s.lastReset>6e4?(l.set(t,{count:1,lastReset:r}),!0):!(s.count>=5)&&(s.count++,!0)}(t))return i.NextResponse.json({error:{code:"RATE_LIMIT_EXCEEDED",message:"Too many requests. Please try again later."}},{status:429});let{name:r,email:s,message:o,honeypot:a}=await e.json();if(!r?.trim()||!s?.trim()||!o?.trim())return i.NextResponse.json({error:{code:"VALIDATION_ERROR",message:"Name, email, and message are required."}},{status:400});if(a)return i.NextResponse.json({error:{code:"SPAM_DETECTED",message:"Invalid submission detected."}},{status:400});if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s))return i.NextResponse.json({error:{code:"INVALID_EMAIL",message:"Please provide a valid email address."}},{status:400});let n={id:Date.now().toString(),name:r.trim(),email:s.trim(),message:o.trim(),ip:t,created_at:new Date().toISOString()};try{let e=(0,u.join)(process.cwd(),"data"),t=(0,u.join)(e,"contacts.json");(0,p.existsSync)(e)||await (0,c.mkdir)(e,{recursive:!0});let r=[];try{if((0,p.existsSync)(t)){let e=await (0,c.readFile)(t,"utf-8");r=JSON.parse(e)}}catch{r=[]}r.push(n),await (0,c.writeFile)(t,JSON.stringify(r,null,2))}catch(e){console.error("Error storing contact:",e)}let d={host:process.env.MAIL_HOST,port:process.env.MAIL_PORT,user:process.env.MAIL_USER,pass:process.env.MAIL_PASS,from:process.env.MAIL_FROM,to:process.env.MAIL_TO};return d.host&&d.user&&d.pass&&console.log("Would send email notification:",{to:d.to,subject:`New contact from ${r}`,body:`Name: ${r}
Email: ${s}
Message: ${o}`}),i.NextResponse.json({ok:!0})}catch(e){return console.error("Contact API error:",e),i.NextResponse.json({error:{code:"INTERNAL_ERROR",message:"An internal error occurred. Please try again later."}},{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/contact/route",pathname:"/api/contact",filename:"route",bundlePath:"app/api/contact/route"},resolvedPagePath:"/home/runner/work/porfolio/porfolio/frontend/src/app/api/contact/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:g,staticGenerationAsyncStorage:f,serverHooks:R}=m,v="/api/contact/route";function x(){return(0,n.patchFetch)({serverHooks:R,staticGenerationAsyncStorage:f})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,972],()=>r(3853));module.exports=s})();